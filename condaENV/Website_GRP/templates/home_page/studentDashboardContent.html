{% extends "home_page/secondaryLayout.html" %}
{% load static %}
{% block layout_css %}
<link rel="stylesheet" href="{% static 'css/studentDashboard.css' %}"/>
<title>Student Dashboard</title>
{% endblock %}
{% block content %}


    {% if ProjectExists %}


            <h2> My Dashboard </h2>
            <table class="table table-hover table-bordered">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Project Name</th>
                        <th>Authors</th>
                        <th>Upload Date</th>
                        <th>Editable Until</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>

                <!-- Fill the table using sql query -->
                <tbody>
                <!-- WHILE LOOP STARTS TO ITERATE THROUGH DATA BASE -->

                    {% for i in getUserProjects %}
                    <tr>

                        <td>{{ forloop.counter }}</td>
                        <td>{{ i.Project_Name }}</td>
                        <td> {{ i.Authors }}</td>
                        <td>{{ i.Upload_Date }}</td>
                        <td> {{i.Account_ExpiryDate}}</td>

                        {% if i.Project_Approval_Status == "Pending" %}
                            <td><!-- FETCH INPUT FROM BACKEND --> Pending</td>
                        {% elif i.Project_Approval_Status == "Approved" %}
                            <td style="color: green"><!-- FETCH INPUT FROM BACKEND --> Approved</td>
                        {% elif i.Project_Approval_Status == "Rejected" %}
                            <td style="color: red"><!-- FETCH INPUT FROM BACKEND --> Rejected</td>
                        {% endif %}

                        {% if i.Project_Approval_Status == "Pending" %}
                            {% if todayDate > i.Account_ExpiryDate %}
                                <td><p style="color: red">No longer editable</p></td>
                            {% else %}
                                <form action="{% url 'home_page:edit_project' %}" method="POST">
                                {% csrf_token %}
                                    <td><button name = "EditProject" value = "{{ i.id }}" type="submit" class="btn btn-primary btn-sm">Edit</button><button class="btn"></td>

                                </form>
                            {% endif %}

                        {% elif i.Project_Approval_Status == "Approved" %}

                                <td><p style="color: red">No longer editable</p></td>


                        {% elif i.Project_Approval_Status == "Rejected" %}

                            {% if todayDate > i.Account_ExpiryDate %}
                                <td><p style="color: red">No longer editable</p></td>
                            {% else %}
                                <form action="{% url 'home_page:edit_project' %}" method="POST">
                                {% csrf_token %}
                                    <td><button name = "EditProject" value = "{{ i.id }}" type="submit" class="btn btn-primary btn-sm">Edit</button><button class="btn"></td>

                                </form>
                            {% endif %}

                        {% endif %}

                    </tr>
                   {% endfor %}
                </tbody>

                <!-- Close table -->
            </table>
                <div class="alert alert-info" role="alert">
                    <p class="mb-0">Please click <a href="{% url 'upload_project' %}" class="alert-link">here</a> to upload more project.</p>
                </div>

    {% else %}

            <h2> My Dashboard </h2>
            <table class="table table-hover table-bordered">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Project Name</th>
                        <th>Authors</th>
                        <th>Upload Date</th>
                        <th>Editable Until</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
            </table>

            <div class="alert alert-info" role="alert">
                <h4 class="alert-heading">You currently do not have any project.</h4>
                <hr>
                <p class="mb-0">Please click <a href="{% url 'upload_project' %}" class="alert-link">here</a> to upload your first project.</p>
            </div>


    {% endif %}



{% endblock %}